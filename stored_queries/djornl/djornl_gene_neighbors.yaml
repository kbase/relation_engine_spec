# Fetch the neighbors of a certain gene by distance
name: djornl_gene_neighbors
params:
  type: object
  required: [gene_key]
  properties:
    distance:
      type: integer
      title: Traversal Distance
      description: How many hops to find neighbors and neighbors-of-neighbors
      default: 1
      minimum: 1
      maximum: 100
    gene_key:
      type: string
      title: Gene Key
      examples: [AT1G01010]
query: |
  FOR g IN djornl_gene
    FILTER g._key == @gene_key
    FOR n, e, p IN @distance ANY g djornl_domain_co_occur, djornl_gene_coexpr, djornl_pheno_assn, djornl_ppi_hithru, djornl_ppi_liter
      OPTIONS {bfs: true, uniqueVertices: "global"}
      LET edges = (
        FOR entry IN p.edges
            RETURN KEEP(entry, "_id", "_from", "_to")
      )
      LET verts = (
        FOR entry IN SLICE(p.vertices, 1)
            RETURN UNSET(entry, "_key", "_rev")
      )
      RETURN {edges, verts}
